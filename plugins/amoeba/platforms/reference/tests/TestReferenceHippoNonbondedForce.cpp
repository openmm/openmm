/* -------------------------------------------------------------------------- *
 *                                   OpenMM                                   *
 * -------------------------------------------------------------------------- *
 * This is part of the OpenMM molecular simulation toolkit originating from   *
 * Simbios, the NIH National Center for Physics-Based Simulation of           *
 * Biological Structures at Stanford, funded under the NIH Roadmap for        *
 * Medical Research, grant U54 GM072970. See https://simtk.org.               *
 *                                                                            *
 * Portions copyright (c) 2019 Stanford University and the Authors.           *
 * Authors: Peter Eastman                                                     *
 * Contributors:                                                              *
 *                                                                            *
 * Permission is hereby granted, free of charge, to any person obtaining a    *
 * copy of this software and associated documentation files (the "Software"), *
 * to deal in the Software without restriction, including without limitation  *
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,   *
 * and/or sell copies of the Software, and to permit persons to whom the      *
 * Software is furnished to do so, subject to the following conditions:       *
 *                                                                            *
 * The above copyright notice and this permission notice shall be included in *
 * all copies or substantial portions of the Software.                        *
 *                                                                            *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR *
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,   *
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL    *
 * THE AUTHORS, CONTRIBUTORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,    *
 * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR      *
 * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE  *
 * USE OR OTHER DEALINGS IN THE SOFTWARE.                                     *
 * -------------------------------------------------------------------------- */

/**
 * This tests the Reference implementation of HippoNonbondedForce.
 */

#include "openmm/internal/AssertionUtilities.h"
#include "openmm/Context.h"
#include "OpenMMAmoeba.h"
#include "openmm/System.h"
#include "openmm/VerletIntegrator.h"
#include <iostream>
#include <vector>

using namespace OpenMM;
using namespace std;

extern "C" OPENMM_EXPORT void registerAmoebaReferenceKernelFactories();

void buildWaterSystem(System& system, int numWaters, HippoNonbondedForce* hippo) {
    system.addForce(hippo);
    for (int mol = 0; mol < numWaters; mol++) {
        system.addParticle(15.995);
        system.addParticle(1.008);
        system.addParticle(1.008);
        double bohr = 0.52917720859;
        double ds = 0.1*bohr;
        double qs = 0.01*bohr*bohr/3.0;
        double c6s = sqrt(4.184)*0.001;
        double ps = sqrt(4.184*0.1);
        hippo->addParticle(-0.38280, {0.0, 0.0, ds*0.05477}, {qs*0.69866, 0.0, 0.0, 0.0, qs*-0.60471, 0.0, 0.0, 0.0, qs*-0.09395}, 6.0,
                    10*4.7075, 4.184*1326.0, 10*40.0, c6s*18.7737, ps*2.7104, -2.4233, 10*4.3097,
                    0.001*0.795, HippoNonbondedForce::Bisector, 3*mol+1, 3*mol+2, -1);
        hippo->addParticle(0.19140, {0.0, 0.0, ds*-0.20097}, {qs*0.03881, 0.0, 0.0, 0.0, qs*0.02214, 0.0, 0.0, 0.0, qs*-0.06095}, 1.0,
                    10*4.7909, 0.0, 10*3.5582, c6s*4.5670, ps*2.0037, -0.8086, 10*4.6450,
                    0.001*0.341, HippoNonbondedForce::ZThenX, 3*mol, 3*mol+2, -1);
        hippo->addParticle(0.19140, {0.0, 0.0, ds*-0.20097}, {qs*0.03881, 0.0, 0.0, 0.0, qs*0.02214, 0.0, 0.0, 0.0, qs*-0.06095}, 1.0,
                    10*4.7909, 0.0, 10*3.5582, c6s*4.5670, ps*2.0037, -0.8086, 10*4.6450,
                    0.001*0.341, HippoNonbondedForce::ZThenX, 3*mol, 3*mol+1, -1);
        hippo->addException(3*mol, 3*mol+1, 0.0, 0.0, 0.2, 0.0, 0.0);
        hippo->addException(3*mol, 3*mol+2, 0.0, 0.0, 0.2, 0.0, 0.0);
        hippo->addException(3*mol+1, 3*mol+2, 0.0, 0.0, 1.0, 0.0, 0.0);
    }
}

void checkForceEnergyConsistency(Context& context) {
    // Find the direction and magnitude of the force.

    State state = context.getState(State::Positions | State::Forces | State::Energy);
    int numParticles = context.getSystem().getNumParticles();
    double norm = 0.0;
    for (int i = 0; i < numParticles; ++i) {
        Vec3 f = state.getForces()[i];
        norm += f[0]*f[0] + f[1]*f[1] + f[2]*f[2];
    }
    norm = std::sqrt(norm);

    // Take a small step in the direction of the force and see whether the potential energy changes by the expected amount.

    const double delta = 1e-3;
    double step = 0.5*delta/norm;
    vector<Vec3> positions2(numParticles), positions3(numParticles);
    for (int i = 0; i < numParticles; ++i) {
        Vec3 p = state.getPositions()[i];
        Vec3 f = state.getForces()[i];
        positions2[i] = Vec3(p[0]-f[0]*step, p[1]-f[1]*step, p[2]-f[2]*step);
        positions3[i] = Vec3(p[0]+f[0]*step, p[1]+f[1]*step, p[2]+f[2]*step);
    }
    context.setPositions(positions2);
    State state2 = context.getState(State::Energy);
    context.setPositions(positions3);
    State state3 = context.getState(State::Energy);
    ASSERT_EQUAL_TOL(state3.getPotentialEnergy()-state2.getPotentialEnergy(), norm*delta, 1e-4)
}

void testWaterDimer() {
    System system;
    HippoNonbondedForce* hippo = new HippoNonbondedForce();
    buildWaterSystem(system, 2, hippo);
    VerletIntegrator integrator(0.001);
    Context context(system, integrator, Platform::getPlatformByName("Reference"));
    vector<Vec3> positions = {
        0.1*Vec3(1.505434, 0.0, -0.065656),
        0.1*Vec3(0.553912, 0.0, 0.057710),
        0.1*Vec3(1.907155, 0.0, 0.801980),
        0.1*Vec3(-1.436029, 0.0, 0.060505),
        0.1*Vec3(-1.781197, 0.772272, -0.388976),
        0.1*Vec3(-1.781197, -0.772272, -0.388976)
    };
    context.setPositions(positions);
    State state = context.getState(State::Energy | State::Forces);
    
    // Compare the forces and energy to reference values computed with Tinker.

    ASSERT_EQUAL_TOL(-18.393623712669680, state.getPotentialEnergy(), 1e-5);
    vector<Vec3> expectedForces = {
        Vec3(-162.94090034728887, 0.0, 35.06615691195519),
        Vec3(127.50063696213348, 0.0, -46.51857483822334),
        Vec3(39.59601328153432, 0.0, 11.805509637931072),
        Vec3(-73.52341534248339, 0.0, -92.08855312751808),
        Vec3(34.68383272305204, -26.35219958830841, 45.867730707927564),
        Vec3(34.68383272305204, 26.35219958830841, 45.867730707927564),
    };
    for (int i = 0; i < system.getNumParticles(); i++)
        ASSERT_EQUAL_VEC(expectedForces[i], state.getForces()[i], 1e-5);
    checkForceEnergyConsistency(context);
}

void testWaterBox() {
    System system;
    HippoNonbondedForce* hippo = new HippoNonbondedForce();
    buildWaterSystem(system, 216, hippo);
    system.setDefaultPeriodicBoxVectors(Vec3(1.8643, 0, 0), Vec3(0, 1.8643, 0), Vec3(0, 0, 1.8643));
    hippo->setNonbondedMethod(HippoNonbondedForce::PME);
    hippo->setCutoffDistance(0.7);
    hippo->setUseSwitchingFunction(true);
    hippo->setSwitchingDistance(0.6);
    hippo->setPMEParameters(3.85037, 24, 24, 24);
    hippo->setDPMEParameters(3.85037, 12, 12, 12);
    VerletIntegrator integrator(0.001);
    Context context(system, integrator, Platform::getPlatformByName("Reference"));
    vector<Vec3> positions = {
        Vec3(0.8679662000000001, 0.7087692, -0.0696862),
        Vec3(0.7809455000000001, 0.6755792, -0.03822590000000001),
        Vec3(0.8722232000000001, 0.6814243000000001, -0.1617561),
        Vec3(-0.0117313, 0.8244446999999999, 0.6837616),
        Vec3(0.021689200000000002, 0.7895445, 0.6050027),
        Vec3(0.0444268, 0.7826013, 0.7530196),
        Vec3(0.8379057, -0.0092611, 0.6814631000000001),
        Vec3(0.9340423, 0.0098069, 0.6734062000000001),
        Vec3(0.7939619000000001, 0.0573676, 0.6269838000000001),
        Vec3(0.6589952000000001, 0.1844323, -0.6923167000000001),
        Vec3(0.5885429000000001, 0.2402305, -0.6717934),
        Vec3(0.6181533, 0.10627470000000001, -0.7273678000000001),
        Vec3(0.7146600000000001, 0.5753582, 0.2331517),
        Vec3(0.6368123, 0.6126035000000001, 0.2862678),
        Vec3(0.7025018000000001, 0.6294645000000001, 0.15181960000000003),
        Vec3(-0.24265810000000002, -0.8504195, -0.25048339999999997),
        Vec3(-0.16920630000000003, -0.8368252, -0.3058292),
        Vec3(-0.27932070000000003, -0.7602469000000001, -0.2403097),
        Vec3(-0.8038375000000001, -0.3605589, 0.23036910000000002),
        Vec3(-0.8113753000000001, -0.42481270000000004, 0.30184940000000005),
        Vec3(-0.7619392, -0.2863004, 0.2709622),
        Vec3(-0.1480631, 0.8244085000000001, -0.8272214999999999),
        Vec3(-0.2090204, 0.8687978, -0.7676996),
        Vec3(-0.0700878, 0.8823325000000001, -0.8322213),
        Vec3(-0.37419620000000003, -0.277783, -0.2326319),
        Vec3(-0.4620456, -0.2444778, -0.23905189999999998),
        Vec3(-0.37289210000000006, -0.3160952, -0.1433101),
        Vec3(-0.6467812000000001, -0.5265942, 0.0408263),
        Vec3(-0.6585076000000001, -0.4796537, -0.0413008),
        Vec3(-0.7021252, -0.4752640000000001, 0.10079579999999999),
        Vec3(0.9273577, 0.5342431000000001, 0.405546),
        Vec3(0.8645939, 0.54665, 0.4837640000000001),
        Vec3(0.8741774, 0.5686149, 0.330282),
        Vec3(0.183016, 0.42767310000000003, -0.6993499000000001),
        Vec3(0.17032750000000002, 0.5223773, -0.6703852000000001),
        Vec3(0.24081130000000003, 0.38534470000000004, -0.6383339000000001),
        Vec3(0.1964382, 0.6832988000000001, 0.8373101000000001),
        Vec3(0.24961350000000004, 0.7215781, 0.9056298),
        Vec3(0.18112830000000002, 0.5905846, 0.8573539000000001),
        Vec3(0.5405568, 0.43889940000000005, 0.7932737000000001),
        Vec3(0.553738, 0.3438955, 0.7781311),
        Vec3(0.47551560000000004, 0.4734908, 0.7290617),
        Vec3(0.32299980000000006, 0.29284170000000004, -0.109065),
        Vec3(0.39310900000000004, 0.3198265, -0.1702769),
        Vec3(0.30044380000000004, 0.37089690000000003, -0.0493266),
        Vec3(0.74624, 0.5262829, 0.613117),
        Vec3(0.8025650000000001, 0.5588493, 0.688177),
        Vec3(0.6935076, 0.4455766, 0.6325405000000001),
        Vec3(-0.8864042, 0.7023845, -0.6659632000000001),
        Vec3(-0.8370939000000001, 0.6372557, -0.7141895),
        Vec3(-0.9489800000000002, 0.7315873, -0.7293125),
        Vec3(-0.45262990000000003, 0.3549989, 0.8030031),
        Vec3(-0.516977, 0.42241270000000003, 0.7731323),
        Vec3(-0.42620959999999997, 0.3801892, 0.8884875),
        Vec3(0.48232860000000005, -0.1386218, 0.40384640000000005),
        Vec3(0.5493155, -0.0669965, 0.4013081),
        Vec3(0.4187463, -0.1101832, 0.33384330000000006),
        Vec3(-0.215115, -0.201706, -0.8593685000000001),
        Vec3(-0.24757090000000004, -0.2320356, -0.7783564000000001),
        Vec3(-0.2650484, -0.2434614, -0.9307384000000001),
        Vec3(0.1944893, 0.49332260000000006, 0.049791),
        Vec3(0.25532210000000005, 0.5263352, 0.1205303),
        Vec3(0.2082534, 0.5590999, -0.020217100000000002),
        Vec3(-0.6827006, -0.5285917000000001, -0.2371899),
        Vec3(-0.7405873000000001, -0.6022738000000001, -0.2075913),
        Vec3(-0.6398443, -0.5453726, -0.3235054),
        Vec3(-0.8538047000000001, -0.7577917000000001, -0.1688532),
        Vec3(-0.8075591, -0.844826, -0.15134550000000002),
        Vec3(-0.9389507, -0.7836271, -0.20518350000000002),
        Vec3(-0.6916556, -0.1100882, -0.5168782000000001),
        Vec3(-0.6365888000000001, -0.1659366, -0.5746209999999999),
        Vec3(-0.6538885, -0.024937400000000002, -0.5325993000000001),
        Vec3(0.6330290000000001, -0.9323893000000001, -0.641663),
        Vec3(0.7026026000000001, -0.9680578000000001, -0.7007727),
        Vec3(0.6812488000000001, -0.8683594, -0.5925798999999999),
        Vec3(-0.24243450000000002, -0.5918126, 0.2701855),
        Vec3(-0.1613829, -0.5486394, 0.2503024),
        Vec3(-0.31447970000000003, -0.5307275, 0.2618121),
        Vec3(0.0637202, -0.6080457, 0.5849135000000001),
        Vec3(0.08923120000000001, -0.6092342000000001, 0.4907709),
        Vec3(-0.0339074, -0.5838972, 0.5853292),
        Vec3(0.5199216, -0.22649180000000002, -0.0138343),
        Vec3(0.5802838, -0.2788698, -0.06975360000000001),
        Vec3(0.567034, -0.1679393, 0.0462296),
        Vec3(0.0510145, 0.7629450000000001, 0.40545000000000003),
        Vec3(-0.007113500000000001, 0.8146563000000001, 0.3452959),
        Vec3(0.14649620000000002, 0.7740819000000001, 0.36691720000000005),
        Vec3(0.3146724, 0.8895843, 0.6526257000000001),
        Vec3(0.3506091, 0.8599906000000002, 0.7352942),
        Vec3(0.21457290000000004, 0.8929622, 0.6682029),
        Vec3(0.7308541000000001, -0.8339335000000001, -0.2471342),
        Vec3(0.6562127000000001, -0.8180601, -0.30628030000000006),
        Vec3(0.6993025, -0.8364954, -0.1531235),
        Vec3(-0.7530792000000001, 0.1069683, 0.4989387),
        Vec3(-0.7565406000000001, 0.19714220000000002, 0.4648636),
        Vec3(-0.793825, 0.0433547, 0.43702660000000004),
        Vec3(0.4452035000000001, 0.2700609, -0.5437815),
        Vec3(0.46033260000000004, 0.3058652, -0.45515900000000004),
        Vec3(0.43864530000000007, 0.1737004, -0.5180418999999999),
        Vec3(0.8427922000000001, -0.8619286000000002, 0.17846910000000002),
        Vec3(0.8340498000000001, -0.8005342000000001, 0.25362250000000003),
        Vec3(0.849672, -0.9530562, 0.2174667),
        Vec3(-0.8109456, 0.175383, -0.3096997),
        Vec3(-0.7245287, 0.1827177, -0.27214170000000004),
        Vec3(-0.8082178000000001, 0.1783171, -0.40593290000000004),
        Vec3(0.27769330000000003, -0.5701955, 0.7748213),
        Vec3(0.3287974, -0.5069688, 0.7233816000000001),
        Vec3(0.19870410000000002, -0.5817355000000001, 0.7200131000000001),
        Vec3(0.36351710000000004, -0.6953519, 0.5339628000000001),
        Vec3(0.33538510000000005, -0.7592789, 0.6031367000000001),
        Vec3(0.2875801, -0.6787975, 0.4740576),
        Vec3(0.6888027000000001, -0.41690230000000006, -0.180019),
        Vec3(0.7559735000000001, -0.4813701, -0.2004669),
        Vec3(0.6603805, -0.3759237, -0.2626496),
        Vec3(-0.4470837000000001, -0.41056400000000004, 0.3415362),
        Vec3(-0.4991607, -0.3358538, 0.31409560000000003),
        Vec3(-0.4791764, -0.43922140000000004, 0.42543870000000006),
        Vec3(0.8282263000000001, -0.0462068, -0.2560579),
        Vec3(0.8776769, -0.1293641, -0.23359450000000004),
        Vec3(0.8760297, 0.038481600000000005, -0.2651128),
        Vec3(0.4737236, 0.161643, 0.49011150000000003),
        Vec3(0.3969692, 0.21683680000000002, 0.5152631000000001),
        Vec3(0.5184651, 0.2148403, 0.4154746),
        Vec3(-0.3497332, -0.5781436000000001, -0.22027130000000003),
        Vec3(-0.4038857, -0.5773824000000001, -0.138168),
        Vec3(-0.415297, -0.6012265000000001, -0.2829379),
        Vec3(-0.2863989, -0.025933400000000002, -0.1857006),
        Vec3(-0.2132201, -0.0027953, -0.1174211),
        Vec3(-0.2873625, -0.12244250000000001, -0.18742530000000002),
        Vec3(0.11383000000000001, 0.11331000000000001, -0.2085899),
        Vec3(0.19655060000000002, 0.150352, -0.1725316),
        Vec3(0.0420521, 0.15344400000000002, -0.1551356),
        Vec3(-0.05613280000000001, 0.4590705, -0.2780017),
        Vec3(-0.0061173, 0.39193560000000005, -0.32941280000000006),
        Vec3(-0.0082763, 0.4733898, -0.19556020000000002),
        Vec3(-0.6423002000000001, -0.17052040000000002, -0.2528225),
        Vec3(-0.7233989000000001, -0.1949552, -0.1975418),
        Vec3(-0.6678416, -0.1321413, -0.33512780000000003),
        Vec3(-0.27721, 0.25522100000000003, -0.0672282),
        Vec3(-0.29074890000000003, 0.34835520000000003, -0.0385605),
        Vec3(-0.2977127, 0.2592348, -0.163582),
        Vec3(0.6708678, -0.4852016, -0.837928),
        Vec3(0.6593474, -0.5094964000000001, -0.7447187),
        Vec3(0.6582524000000001, -0.5591596, -0.8966502000000001),
        Vec3(-0.8497001, -0.0440284, 0.2803721),
        Vec3(-0.8422350000000001, 0.0331961, 0.2183451),
        Vec3(-0.9377295000000001, -0.07561600000000002, 0.2677026),
        Vec3(0.2975383, -0.08949700000000001, 0.6060783000000001),
        Vec3(0.2093991, -0.09957, 0.5670129),
        Vec3(0.34588320000000006, -0.07592480000000001, 0.5263958),
        Vec3(-0.6085023, -0.16296200000000002, 0.7970284000000001),
        Vec3(-0.6685848000000001, -0.23918300000000003, 0.7820849000000001),
        Vec3(-0.6177296000000001, -0.11905840000000001, 0.8835912000000001),
        Vec3(-0.37635230000000003, -0.3356777, 0.8285436000000002),
        Vec3(-0.46606500000000006, -0.3029414, 0.8406662000000001),
        Vec3(-0.3411834, -0.31789470000000003, 0.7431180000000001),
        Vec3(-0.110012, -0.0320162, 0.0375372),
        Vec3(-0.0527013, -0.10121830000000001, 0.0128652),
        Vec3(-0.0673226, 0.028855900000000004, 0.0934677),
        Vec3(0.09102090000000002, -0.8271801999999999, 0.14114290000000002),
        Vec3(0.0158544, -0.8759532000000001, 0.18708950000000002),
        Vec3(0.0565924, -0.7546113000000001, 0.0944383),
        Vec3(0.1554065, -0.6468033000000001, 0.3310872),
        Vec3(0.1362455, -0.7162802, 0.27223400000000003),
        Vec3(0.16162330000000003, -0.5622409, 0.28728539999999997),
        Vec3(0.054312700000000005, -0.1388652, 0.4886094),
        Vec3(0.011032, -0.0665826, 0.5311239),
        Vec3(0.04203660000000001, -0.22163670000000002, 0.5267301),
        Vec3(0.1100526, 0.10194900000000001, -0.9255318000000001),
        Vec3(0.1460815, 0.0575286, -0.8484128000000001),
        Vec3(0.0265613, 0.0594128, -0.9297750000000001),
        Vec3(-0.18423480000000003, 0.2327827, -0.5355326),
        Vec3(-0.1572941, 0.2573139, -0.6288125),
        Vec3(-0.22166790000000003, 0.14399340000000002, -0.5361006),
        Vec3(0.2452307, -0.2814686, -0.6448759000000001),
        Vec3(0.2862295, -0.3091668, -0.5589336),
        Vec3(0.29139200000000004, -0.3262923, -0.7181510000000001),
        Vec3(-0.2207998, -0.31120070000000005, 0.5945795),
        Vec3(-0.1262203, -0.31253390000000003, 0.6205467),
        Vec3(-0.22282690000000002, -0.2421858, 0.5220629),
        Vec3(0.5845471, 0.5020556, -0.6836491),
        Vec3(0.5557986, 0.5913737, -0.6753889000000001),
        Vec3(0.5089998, 0.4459153, -0.6661079000000001),
        Vec3(-0.34216430000000003, 0.4865553, 0.0731755),
        Vec3(-0.3965419, 0.44584520000000005, 0.1478214),
        Vec3(-0.3973445, 0.49583380000000005, -0.004443),
        Vec3(-0.23029500000000003, -0.2349717, 0.2112168),
        Vec3(-0.25764380000000003, -0.1873492, 0.2873191),
        Vec3(-0.1882868, -0.1715106, 0.15037820000000002),
        Vec3(0.030588500000000005, 0.4878766, 0.3791182),
        Vec3(0.0299338, 0.5855407, 0.40975780000000006),
        Vec3(0.1169911, 0.4563497, 0.4030616),
        Vec3(0.2925008, -0.36648450000000005, -0.36074500000000004),
        Vec3(0.3015896, -0.39166180000000006, -0.2644267),
        Vec3(0.2353923, -0.28894590000000003, -0.35182840000000004),
        Vec3(0.1111505, -0.40702550000000004, -0.9085692999999999),
        Vec3(0.20849050000000002, -0.4227348, -0.9180249),
        Vec3(0.0897072, -0.49022180000000004, -0.8740523),
        Vec3(-0.49929290000000004, -0.1974219, -0.7099668000000001),
        Vec3(-0.5173269, -0.11863090000000001, -0.7673625000000001),
        Vec3(-0.5070893, -0.2753273, -0.7658821),
        Vec3(0.4730983, 0.147842, 0.0720986),
        Vec3(0.4271686, 0.19882650000000002, 0.0034225),
        Vec3(0.41174130000000003, 0.0788607, 0.10618179999999999),
        Vec3(0.14215830000000002, -0.0176666, -0.6729105),
        Vec3(0.121766, 0.0394331, -0.5978213),
        Vec3(0.19484440000000003, -0.08779880000000001, -0.6400659000000001),
        Vec3(-0.7093223000000001, -0.8541193, 0.4116187),
        Vec3(-0.7074252000000001, -0.8047477000000001, 0.3242159),
        Vec3(-0.6153142, -0.8537148000000001, 0.445555),
        Vec3(0.838254, -0.6460958, 0.3765735),
        Vec3(0.9258625, -0.6141972, 0.4060763),
        Vec3(0.7637364, -0.621791, 0.44078520000000004),
        Vec3(-0.4320241, 0.40371370000000006, 0.32970920000000004),
        Vec3(-0.3750151, 0.4141786, 0.41054700000000005),
        Vec3(-0.5172925, 0.4455578, 0.34889060000000005),
        Vec3(0.5581877000000001, 0.1781994, 0.7505132),
        Vec3(0.5017196, 0.1139584, 0.8120950000000001),
        Vec3(0.5330781, 0.15912170000000003, 0.6595286),
        Vec3(-0.0734443, 0.1125031, 0.48846660000000003),
        Vec3(-0.0239224, 0.1540322, 0.41420700000000005),
        Vec3(-0.0961628, 0.1783437, 0.5554548),
        Vec3(0.6831005000000001, -0.924997, 0.4497165),
        Vec3(0.6836746, -0.9068011, 0.5427145999999999),
        Vec3(0.7668067000000001, -0.965251, 0.42499570000000003),
        Vec3(0.2714055, -0.36775810000000003, 0.1962003),
        Vec3(0.33334320000000006, -0.3851775, 0.266354),
        Vec3(0.3095021, -0.3978526, 0.1102566),
        Vec3(-0.1364034, -0.5762724, -0.5514747),
        Vec3(-0.2238584, -0.5409106, -0.5314718),
        Vec3(-0.0948185, -0.4908428, -0.5559580000000001),
        Vec3(-0.36234350000000004, -0.8061229000000001, 0.1383141),
        Vec3(-0.3132847, -0.7446722000000001, 0.18579060000000003),
        Vec3(-0.4307943, -0.7546630000000001, 0.0933298),
        Vec3(0.5717894, 0.6958376000000001, 0.4528556),
        Vec3(0.5852657, 0.7879846, 0.434179),
        Vec3(0.6443636, 0.6708413000000001, 0.5135144),
        Vec3(0.8121415000000001, 0.8262619000000001, -0.8483986),
        Vec3(0.8585190000000001, 0.8939651, -0.8974230000000001),
        Vec3(0.7560207000000001, 0.7748539000000001, -0.9044644000000001),
        Vec3(-0.5111889, -0.0352865, 0.5807903),
        Vec3(-0.5940048, 0.0102298, 0.556963),
        Vec3(-0.5349104, -0.101409, 0.6507582000000001),
        Vec3(0.0327324, 0.2563438, 0.011325100000000001),
        Vec3(-0.0633994, 0.25221360000000004, -0.0069385),
        Vec3(0.0724331, 0.3482989, 0.016056400000000002),
        Vec3(-0.6003367000000001, -0.7683112000000001, -0.8874252),
        Vec3(-0.6987751000000001, -0.7912403000000001, -0.8892689000000001),
        Vec3(-0.5699015000000001, -0.8504722, -0.8558813000000001),
        Vec3(0.0789377, -0.6357883000000001, -0.7563043),
        Vec3(-0.015110100000000001, -0.6341313000000001, -0.7440906),
        Vec3(0.10908810000000001, -0.5879281, -0.6770796),
        Vec3(0.5045666, 0.7219298000000001, -0.5151826),
        Vec3(0.5598994, 0.7846492, -0.5618276),
        Vec3(0.5480466, 0.6978976000000001, -0.4337211),
        Vec3(0.1286092, 0.6990271, -0.6806004),
        Vec3(0.048132900000000006, 0.7140371000000001, -0.7345224),
        Vec3(0.1716012, 0.7791024000000001, -0.6762706),
        Vec3(-0.31987830000000006, -0.9175883000000001, -0.6334156000000001),
        Vec3(-0.30327210000000004, -0.8198157, -0.6198635000000001),
        Vec3(-0.3084774, -0.9539992, -0.5434969),
        Vec3(-0.2002554, -0.5668583, 0.5440781),
        Vec3(-0.23474930000000002, -0.4756386, 0.5542471),
        Vec3(-0.21330269999999998, -0.6049986, 0.4540349),
        Vec3(0.6174952, -0.8574733000000001, 0.0210584),
        Vec3(0.5358389, -0.8191902000000001, 0.0557392),
        Vec3(0.6760918, -0.856171, 0.0943985),
        Vec3(-0.627861, 0.6057339, 0.40423580000000003),
        Vec3(-0.6169211, 0.6708022, 0.3383078),
        Vec3(-0.7221766000000001, 0.5771239, 0.40322050000000004),
        Vec3(0.0124733, -0.5816398, 0.0203961),
        Vec3(0.0029974000000000003, -0.5049468, 0.07868710000000001),
        Vec3(-0.0458026, -0.5646677000000001, -0.0555312),
        Vec3(0.3839311, -0.0064469, 0.861972),
        Vec3(0.35862530000000004, -0.0282978, 0.7705313),
        Vec3(0.30799360000000003, 0.0282626, 0.9065559000000001),
        Vec3(0.7375986000000001, -0.1368885, 0.4452411),
        Vec3(0.8024931000000001, -0.0682735, 0.4768078),
        Vec3(0.7477247, -0.1279372, 0.3493009),
        Vec3(0.9209092000000001, -0.1611532, -0.6423337),
        Vec3(0.9487648000000001, -0.2470973, -0.6800897),
        Vec3(0.9998917, -0.1354277, -0.5866779000000001),
        Vec3(-0.5314625000000001, -0.5613762000000001, 0.7941745),
        Vec3(-0.5589748, -0.6389969, 0.8478078),
        Vec3(-0.4444519, -0.5357513, 0.814946),
        Vec3(-0.36558840000000004, 0.2941259, -0.3295211),
        Vec3(-0.4418712, 0.25281630000000005, -0.3712668),
        Vec3(-0.29375680000000004, 0.30250050000000006, -0.3971189),
        Vec3(-0.8786626000000001, -0.31490900000000005, -0.16403790000000001),
        Vec3(-0.8441651000000001, -0.4011755, -0.1901885),
        Vec3(-0.9285717, -0.3276173, -0.08345350000000001),
        Vec3(-0.7358188000000001, 0.8239942, -0.2093781),
        Vec3(-0.7811518000000001, 0.7751233000000001, -0.2768278),
        Vec3(-0.689243, 0.7625331000000001, -0.1541437),
        Vec3(0.3770974, -0.0453172, -0.1931225),
        Vec3(0.42457570000000006, -0.09662180000000001, -0.12861140000000001),
        Vec3(0.3797803, 0.0441972, -0.15421800000000002),
        Vec3(0.2205813, 0.40988939999999996, 0.8958738),
        Vec3(0.3001973, 0.355544, 0.8746430000000001),
        Vec3(0.2103639, 0.42436680000000004, 0.9940011000000001),
        Vec3(-0.8723398, -0.8284874000000001, -0.8890692),
        Vec3(-0.9298972, -0.7537539, -0.9239127),
        Vec3(-0.8772683000000001, -0.8361037, -0.792594),
        Vec3(-0.8908952, 0.0807167, -0.7785764000000001),
        Vec3(-0.906123, -0.006191200000000001, -0.7422589),
        Vec3(-0.9534219, 0.1030144, -0.8475490000000001),
        Vec3(0.9182207, -0.3418263, -0.8430667000000001),
        Vec3(0.9046738, -0.2558299, -0.8879898000000002),
        Vec3(0.8390804, -0.39587340000000004, -0.8701949000000001),
        Vec3(0.10031620000000002, 0.9279866999999999, -0.8313986),
        Vec3(0.1167271, 1.0190392, -0.8070619000000001),
        Vec3(0.18499620000000003, 0.8761188000000001, -0.8493178000000001),
        Vec3(-0.1842572, 0.4893383, 0.8198130000000001),
        Vec3(-0.246821, 0.5316242, 0.8833179),
        Vec3(-0.1155294, 0.438941, 0.8716281000000001),
        Vec3(-0.40050549999999996, -0.3953707, 0.040234700000000005),
        Vec3(-0.36821480000000006, -0.3305443, 0.10587690000000001),
        Vec3(-0.4738199, -0.44524340000000007, 0.0841144),
        Vec3(0.35118150000000004, -0.7590537, -0.9004707000000001),
        Vec3(0.3415066, -0.7281286, -0.8094635000000001),
        Vec3(0.325155, -0.6835442, -0.9579171000000001),
        Vec3(-0.7614136, -0.7773463, 0.1262079),
        Vec3(-0.7489497, -0.6927033, 0.0753779),
        Vec3(-0.8528840000000001, -0.8050689000000001, 0.11647099999999999),
        Vec3(-0.5419143000000001, 0.706188, -0.5745275000000001),
        Vec3(-0.4504905, 0.6840455000000001, -0.5750772000000001),
        Vec3(-0.5895918, 0.6221393000000001, -0.5676189),
        Vec3(-0.9017162000000001, 0.18887810000000002, 0.09378130000000001),
        Vec3(-0.9868157000000001, 0.21150560000000002, 0.0623903),
        Vec3(-0.8466599000000001, 0.1708818, 0.0191067),
        Vec3(-0.8037596000000001, -0.5106016000000001, 0.47508020000000006),
        Vec3(-0.7322228000000001, -0.5707104000000001, 0.5043673000000001),
        Vec3(-0.8230169, -0.44810510000000003, 0.5475067),
        Vec3(-0.43905459999999996, 0.16915020000000003, -0.7756245),
        Vec3(-0.35588440000000005, 0.12649660000000001, -0.7996466),
        Vec3(-0.41361210000000004, 0.2629917, -0.7760619000000001),
        Vec3(-0.3975194, -0.6218233, -0.692733),
        Vec3(-0.3085645, -0.6066352, -0.7325296),
        Vec3(-0.46408150000000004, -0.6676349, -0.7524295000000001),
        Vec3(0.8240648, 0.5082183, -0.8857912000000001),
        Vec3(0.7453645, 0.5101728, -0.8259448000000001),
        Vec3(0.8368223000000001, 0.4228825, -0.9227974),
        Vec3(0.1598931, -0.18297960000000002, -0.0316752),
        Vec3(0.1992252, -0.1475465, -0.11498150000000001),
        Vec3(0.1726926, -0.2749881, -0.0397199),
        Vec3(0.1433819, -0.13867020000000002, -0.3304673),
        Vec3(0.1323094, -0.0486757, -0.306711),
        Vec3(0.0623143, -0.18020160000000002, -0.3264828),
        Vec3(0.3735991, 0.5554990000000001, 0.6219603),
        Vec3(0.33209160000000004, 0.6265941, 0.6761937),
        Vec3(0.4195666, 0.6053207, 0.5526652000000001),
        Vec3(-0.6285976, -0.9228132000000001, -0.4460410000000001),
        Vec3(-0.5683885000000001, -1.0005163, -0.47408700000000004),
        Vec3(-0.6707036000000001, -0.9488426000000001, -0.36084380000000005),
        Vec3(0.40362000000000003, -0.3378299, 0.6905724000000001),
        Vec3(0.34574410000000005, -0.2618106, 0.6794504),
        Vec3(0.4929409, -0.2991177, 0.6666963),
        Vec3(0.0606517, 0.8561279000000002, -0.37824060000000004),
        Vec3(0.049809900000000004, 0.9526035, -0.36992990000000003),
        Vec3(0.1288545, 0.8500162, -0.4475972),
        Vec3(-0.5666717, 0.8368298, -0.8299623),
        Vec3(-0.49266610000000005, 0.7904359000000001, -0.8744783),
        Vec3(-0.5742748, 0.8095703000000001, -0.7389592),
        Vec3(-0.3344692, 0.7636718, 0.34758300000000003),
        Vec3(-0.4140634000000001, 0.7105012, 0.32964720000000003),
        Vec3(-0.33507970000000004, 0.7470949, 0.44333500000000003),
        Vec3(-0.13221860000000002, 0.6638182, 0.0028906),
        Vec3(-0.18950880000000003, 0.6054034, 0.0554933),
        Vec3(-0.1928852, 0.7271511, -0.0442137),
        Vec3(0.8793551000000002, 0.692545, 0.7841717),
        Vec3(0.9639675000000001, 0.7325848, 0.785068),
        Vec3(0.8776882000000001, 0.6398711, 0.8674035999999999),
        Vec3(-0.6322101, 0.0607808, 0.11740990000000001),
        Vec3(-0.5647986, 0.1150825, 0.15883480000000003),
        Vec3(-0.5852992, -0.0060471, 0.066073),
        Vec3(0.5685139, -0.35460460000000005, -0.41285489999999997),
        Vec3(0.47279660000000007, -0.3473549, -0.4165755),
        Vec3(0.6024761000000001, -0.2749532, -0.4610993),
        Vec3(0.38219990000000004, 0.6538527000000001, 0.167803),
        Vec3(0.3549684, 0.7331168, 0.1175762),
        Vec3(0.3816423, 0.6788603000000001, 0.2602522),
        Vec3(0.3892622, -0.7034239000000001, -0.6415978),
        Vec3(0.4720509, -0.6539827, -0.6295004),
        Vec3(0.32628100000000004, -0.6550918000000001, -0.589037),
        Vec3(0.5454437000000001, 0.3881722, -0.2767521),
        Vec3(0.5906266, 0.32404890000000003, -0.32722500000000004),
        Vec3(0.6116652, 0.4657253, -0.2669082),
        Vec3(-0.4179373, -0.8326009000000001, 0.43950050000000007),
        Vec3(-0.3737878, -0.8754474999999999, 0.5134173),
        Vec3(-0.39345840000000004, -0.882532, 0.3534465),
        Vec3(0.7949488, -0.13534980000000002, 0.9244688000000001),
        Vec3(0.7234465000000001, -0.1100736, 0.9869694000000001),
        Vec3(0.8010855, -0.0754076, 0.8476271000000001),
        Vec3(0.44986030000000005, -0.42192670000000004, 0.3963173),
        Vec3(0.48952260000000003, -0.3311215, 0.4147093),
        Vec3(0.48023710000000003, -0.48716980000000004, 0.4671292),
        Vec3(-0.430725, 0.7384668, -0.28794620000000004),
        Vec3(-0.3402854, 0.7237543, -0.3252031),
        Vec3(-0.41432310000000006, 0.7834459, -0.2019767),
        Vec3(0.28687520000000005, -0.041838900000000005, 0.19093400000000002),
        Vec3(0.2544472, -0.0880398, 0.1179279),
        Vec3(0.20828410000000003, -0.0227627, 0.24579640000000003),
        Vec3(0.7961389, 0.1611971, 0.4525253),
        Vec3(0.7498497000000001, 0.18331740000000002, 0.3728113),
        Vec3(0.884188, 0.20509960000000002, 0.4576281),
        Vec3(0.2692467, -0.45179460000000005, -0.0884665),
        Vec3(0.17894350000000003, -0.48356170000000004, -0.0587396),
        Vec3(0.3330887, -0.5126025000000001, -0.04746790000000001),
        Vec3(0.0711797, 0.1680547, -0.4780435),
        Vec3(0.08545960000000001, 0.15679110000000002, -0.3850059),
        Vec3(-0.0187286, 0.1868256, -0.4936632000000001),
        Vec3(0.45582000000000006, -0.0044434, -0.4673875),
        Vec3(0.5376141, -0.0551202, -0.4913295),
        Vec3(0.44096, -0.0197728, -0.37395550000000005),
        Vec3(0.7109730000000001, 0.045347500000000006, -0.026884400000000003),
        Vec3(0.6996444, 0.009859900000000001, -0.1119484),
        Vec3(0.6343115, 0.1050849, -0.0110689),
        Vec3(-0.2549577, -0.0200852, -0.4492507),
        Vec3(-0.3199039, -0.0856439, -0.48887520000000007),
        Vec3(-0.260512, -0.0151501, -0.3534),
        Vec3(-0.8527353, 0.4524174000000001, -0.23474080000000003),
        Vec3(-0.7662213000000001, 0.43424660000000004, -0.21048520000000004),
        Vec3(-0.8794374, 0.36967930000000004, -0.279574),
        Vec3(-0.28204310000000005, -0.07004780000000001, 0.4413266),
        Vec3(-0.20883430000000003, -0.0069797, 0.45305210000000007),
        Vec3(-0.3535913, -0.0413547, 0.5069151),
        Vec3(0.6924598, -0.1285634, -0.4901833),
        Vec3(0.7496477, -0.083151, -0.4206076000000001),
        Vec3(0.7527035, -0.1446676, -0.5677236),
        Vec3(-0.5353763, 0.6572088, 0.6734366),
        Vec3(-0.4428432, 0.6663173, 0.6834862),
        Vec3(-0.5603600000000001, 0.6385787, 0.5822425),
        Vec3(0.7661597000000001, 0.2386104, 0.9175259000000001),
        Vec3(0.7321694000000001, 0.2395921, 1.0055536),
        Vec3(0.6959141, 0.21022, 0.8533079000000001),
        Vec3(-0.349659, -0.3765912, -0.4994838),
        Vec3(-0.36121810000000004, -0.3620689, -0.4036115),
        Vec3(-0.4323649, -0.35278160000000003, -0.5463213),
        Vec3(-0.9351953000000001, 0.8343146000000001, 0.3704719),
        Vec3(-0.8465363, 0.8758592000000001, 0.3736785),
        Vec3(-0.9159223000000001, 0.7399420000000001, 0.3880808),
        Vec3(-0.0957571, -0.5174275, -0.21901700000000002),
        Vec3(-0.19073450000000003, -0.5209294, -0.23031640000000003),
        Vec3(-0.0758582, -0.4314608, -0.2636469),
        Vec3(0.5048831, -0.7988284000000001, 0.25875149999999997),
        Vec3(0.5870168, -0.8296198000000001, 0.30438160000000003),
        Vec3(0.455197, -0.7498875, 0.32292800000000005),
        Vec3(0.37056580000000006, 0.8368298, -0.8304931),
        Vec3(0.38606070000000003, 0.9297256000000002, -0.8425405),
        Vec3(0.3866516, 0.8146007000000002, -0.7371475000000001),
        Vec3(-0.25351340000000006, 0.7116414, 0.6338590000000001),
        Vec3(-0.19188840000000001, 0.7705593000000001, 0.6804078),
        Vec3(-0.19752250000000002, 0.6330832000000001, 0.6121365000000001),
        Vec3(-0.3440263, 0.7005018000000001, 0.9111704),
        Vec3(-0.2633953, 0.7421761, 0.9465848),
        Vec3(-0.3654896, 0.7513753000000001, 0.825647),
        Vec3(0.6452501, -0.5478051, -0.5722874),
        Vec3(0.7297698, -0.5914122, -0.5586895000000001),
        Vec3(0.6253267, -0.4919338, -0.4937095),
        Vec3(-0.6528475, 0.4497861000000001, -0.5573636),
        Vec3(-0.625784, 0.46840560000000003, -0.4656222),
        Vec3(-0.7247764000000001, 0.3931701, -0.5623068),
        Vec3(-0.7310706, 0.8183648, 0.7852201000000001),
        Vec3(-0.6552879, 0.7735013000000001, 0.7436342),
        Vec3(-0.6877865000000001, 0.8451022, 0.8686616000000001),
        Vec3(-0.1476441, -0.7867001, 0.7421787000000001),
        Vec3(-0.0852398, -0.8570669000000001, 0.7084405),
        Vec3(-0.136374, -0.7190554, 0.6737331000000001),
        Vec3(0.5228019, -0.049587, -0.7592953),
        Vec3(0.4737616, -0.053813900000000005, -0.6742036),
        Vec3(0.4625354, -0.09013290000000002, -0.8269022),
        Vec3(0.7566531000000001, -0.10067340000000001, 0.18082130000000002),
        Vec3(0.7657411000000001, -0.1866188, 0.1428564),
        Vec3(0.7358547, -0.0388051, 0.11399429999999999),
        Vec3(0.18509240000000002, -0.5717449, -0.5035416),
        Vec3(0.172104, -0.6227449, -0.4217213),
        Vec3(0.2199319, -0.48563780000000006, -0.46928919999999996),
        Vec3(-0.8904325000000001, 0.6791585000000001, -0.38428660000000003),
        Vec3(-0.8690637000000001, 0.5952111999999999, -0.3490118),
        Vec3(-0.8676001, 0.6844077000000001, -0.4770651),
        Vec3(-0.3434304, 0.43971980000000005, -0.7863568000000001),
        Vec3(-0.26347770000000004, 0.3892027, -0.7779256000000001),
        Vec3(-0.34328470000000005, 0.5161485, -0.7310788),
        Vec3(-0.7446738, 0.6124823, 0.0150068),
        Vec3(-0.7404893000000001, 0.5207959, 0.0481504),
        Vec3(-0.8405563000000001, 0.6215466000000001, -0.0024439),
        Vec3(0.019533000000000002, -0.7307128, -0.3501714),
        Vec3(-0.0240912, -0.6769004000000001, -0.42436550000000006),
        Vec3(-0.019491500000000002, -0.6981989, -0.267986),
        Vec3(0.7068819000000001, 0.9130323000000001, 0.7260588000000001),
        Vec3(0.6559855, 0.8400987000000001, 0.7699406),
        Vec3(0.7972497000000001, 0.8829223000000002, 0.7213747),
        Vec3(-0.0185218, -0.319229, -0.6289346),
        Vec3(0.0776651, -0.3073203, -0.6391948000000001),
        Vec3(-0.0497426, -0.2964088, -0.7170893),
        Vec3(-0.20736300000000002, 0.4369672, 0.5251074),
        Vec3(-0.18686380000000002, 0.3811508, 0.6060261),
        Vec3(-0.1253174, 0.4326708, 0.478168),
        Vec3(-0.0855003, 0.30691080000000004, -0.7935226000000001),
        Vec3(0.007575800000000001, 0.3132202, -0.7617253),
        Vec3(-0.10098450000000002, 0.22074870000000002, -0.8320426),
        Vec3(-0.6328833, 0.0064083000000000005, -0.8467228000000001),
        Vec3(-0.7268416000000001, 0.0384648, -0.8383978000000001),
        Vec3(-0.5825246000000001, 0.09193040000000001, -0.8320175000000001),
        Vec3(-0.8276352, -0.8809851000000001, -0.634491),
        Vec3(-0.7541457, -0.8792368, -0.5688031),
        Vec3(-0.8510208000000001, -0.9731116000000001, -0.6353248),
        Vec3(0.0463654, 0.28267760000000003, 0.7018388),
        Vec3(0.08753240000000001, 0.3588447, 0.7482107),
        Vec3(0.0770257, 0.2126646, 0.758365),
        Vec3(0.0478371, -0.3407198, 0.6910039000000001),
        Vec3(0.0585298, -0.299675, 0.7756467),
        Vec3(0.055653100000000004, -0.4390636, 0.7183527000000001),
        Vec3(-0.16895590000000002, 0.7002511, -0.33035610000000004),
        Vec3(-0.10091520000000001, 0.7635432, -0.3553133),
        Vec3(-0.1333699, 0.6195680000000001, -0.2919485),
        Vec3(0.9000097, -0.6227871, 0.8137681000000001),
        Vec3(0.9373858, -0.6821152, 0.7497417000000001),
        Vec3(0.8024020000000001, -0.6011019000000001, 0.8033727000000002),
        Vec3(0.1272378, 0.1954065, 0.3058033),
        Vec3(0.1260842, 0.2615112, 0.2341207),
        Vec3(0.1890312, 0.2223439, 0.37329340000000005),
        Vec3(0.4139066, -0.3527427, -0.9022608999999999),
        Vec3(0.4070028, -0.34991170000000005, -0.9985525000000002),
        Vec3(0.4960292, -0.39423640000000004, -0.8778433),
        Vec3(0.7176276, 0.2178662, -0.407594),
        Vec3(0.6995275000000001, 0.1684022, -0.48732230000000004),
        Vec3(0.7621313000000001, 0.2984315, -0.43939940000000005),
        Vec3(-0.0034836, -0.3929919, 0.21480950000000001),
        Vec3(0.08380030000000001, -0.3513346, 0.22596630000000004),
        Vec3(-0.0654999, -0.32885810000000004, 0.2426748),
        Vec3(-0.8701616, 0.27952370000000004, -0.5700842),
        Vec3(-0.8848959000000001, 0.2145603, -0.6420186000000001),
        Vec3(-0.9464654, 0.3362988, -0.5610379),
        Vec3(0.28044440000000004, 0.8909551000000001, -0.5635389000000001),
        Vec3(0.3063615, 0.9805993000000002, -0.5770957),
        Vec3(0.3512196, 0.8486179, -0.5165468),
        Vec3(0.3236002, 0.8357402, 0.36366390000000004),
        Vec3(0.34508540000000004, 0.9071799, 0.3073263),
        Vec3(0.3476445, 0.8586691000000001, 0.4607935000000001),
        Vec3(0.5628532, 0.7185941, 0.8510937000000001),
        Vec3(0.5467837000000001, 0.6318153, 0.8138885),
        Vec3(0.4964153, 0.7477925000000001, 0.9150467000000001),
        Vec3(-0.3767261, 0.12603899999999998, 0.2017681),
        Vec3(-0.37077340000000003, 0.20195200000000002, 0.2565591),
        Vec3(-0.33646020000000004, 0.1609935, 0.1212351),
        Vec3(0.8228917, -0.34417610000000004, 0.0850139),
        Vec3(0.9022130000000002, -0.3709208, 0.1334881),
        Vec3(0.7553662000000001, -0.3976731, 0.1276651),
        Vec3(-0.3004292, 0.1345869, 0.7236734),
        Vec3(-0.3715311, 0.0724731, 0.6912689000000001),
        Vec3(-0.3525684, 0.21119010000000002, 0.7538936),
        Vec3(0.49014230000000003, -0.5547141, -0.0119795),
        Vec3(0.532755, -0.5560969, 0.076977),
        Vec3(0.5447642, -0.49307520000000005, -0.0617088),
        Vec3(-0.33062100000000005, 0.8469477, -0.04950570000000001),
        Vec3(-0.2836855, 0.9122642000000001, -0.1080706),
        Vec3(-0.3311215, 0.8916887, 0.0353875),
        Vec3(-0.6572180000000001, 0.3018421, -0.026207900000000003),
        Vec3(-0.6711444000000001, 0.26599560000000005, 0.060646000000000005),
        Vec3(-0.6040782, 0.2473886, -0.0843542),
        Vec3(-0.5429147000000001, -0.5967833, 0.5177682),
        Vec3(-0.4896648, -0.6608203, 0.46925340000000004),
        Vec3(-0.5386594, -0.6130690000000001, 0.6117931),
        Vec3(0.6054430000000001, 0.7035601, 0.0031519),
        Vec3(0.5939348, 0.7951184, -0.014109400000000001),
        Vec3(0.5390949, 0.6866654, 0.0702638),
        Vec3(-0.08902290000000002, -0.2615376, -0.3621726),
        Vec3(-0.1695442, -0.2097314, -0.35379760000000005),
        Vec3(-0.0895128, -0.2637531, -0.4561712),
        Vec3(-0.5446979, 0.0994907, -0.21067140000000004),
        Vec3(-0.4494883, 0.09979120000000001, -0.1881595),
        Vec3(-0.5759736000000001, 0.009419900000000002, -0.1919247),
        Vec3(-0.7517688, -0.40783400000000003, 0.7202707),
        Vec3(-0.8242348, -0.4324693, 0.7729813000000001),
        Vec3(-0.6924399000000001, -0.48174530000000004, 0.726943),
        Vec3(-0.1134884, 0.8628488000000001, 0.20810689999999998),
        Vec3(-0.1962897, 0.8634713, 0.2554947),
        Vec3(-0.1119731, 0.7882422, 0.15160030000000002),
        Vec3(-0.6288317000000001, 0.8011683, 0.20221290000000003),
        Vec3(-0.6404647, 0.8858198, 0.1546109),
        Vec3(-0.6669138000000001, 0.7315199, 0.14826140000000002),
        Vec3(-0.6766934, -0.4026505, -0.8306645),
        Vec3(-0.6542552, -0.4855702, -0.8828363),
        Vec3(-0.7743726, -0.3954163, -0.8170031),
        Vec3(0.6895244, 0.7052113000000001, -0.30312890000000003),
        Vec3(0.7810039, 0.7265357, -0.3330751),
        Vec3(0.6666757, 0.7541675, -0.22021780000000002),
        Vec3(0.800326, 0.4735929, -0.5168656),
        Vec3(0.7233375, 0.4730204, -0.5685772),
        Vec3(0.8406708, 0.562958, -0.5300038),
        Vec3(-0.523016, -0.6461196, -0.4390836),
        Vec3(-0.5701558999999999, -0.7313756, -0.4377348),
        Vec3(-0.48555450000000006, -0.632797, -0.5273443999999999),
        Vec3(-0.3803496, -0.9221115, 0.7305476),
        Vec3(-0.2934288, -0.8877999000000001, 0.7425047),
        Vec3(-0.4416066, -0.8566250000000001, 0.7573191),
        Vec3(-0.5990438, -0.1574415, 0.30725210000000003),
        Vec3(-0.5805447, -0.11192930000000001, 0.39337310000000003),
        Vec3(-0.6651651000000001, -0.0947206, 0.2634773),
        Vec3(0.11554510000000001, 0.7138377, -0.11783170000000001),
        Vec3(0.0330359, 0.7363227000000001, -0.0724568),
        Vec3(0.10551450000000001, 0.7478676000000001, -0.2100793),
        Vec3(-0.5886817, 0.5150957, -0.2997276),
        Vec3(-0.5191777000000001, 0.4556623, -0.2611465),
        Vec3(-0.5401622, 0.6003350000000001, -0.3064194),
        Vec3(0.2539927, 0.3387568, 0.49761800000000006),
        Vec3(0.1760904, 0.3182324, 0.5589217),
        Vec3(0.2841539, 0.4315465, 0.5278853),
        Vec3(0.8331859, -0.7344673, -0.5188191),
        Vec3(0.8424401, -0.7586778000000001, -0.4198621),
        Vec3(0.8911675000000001, -0.7764424000000001, -0.5823267000000001),
        Vec3(-0.5774081, 0.1315144, -0.5304553000000001),
        Vec3(-0.5222992, 0.1580336, -0.6077077000000001),
        Vec3(-0.6219878, 0.21784409999999998, -0.509336),
        Vec3(0.6340084, -0.49260640000000006, 0.2149626),
        Vec3(0.5639784, -0.4766017, 0.2829591),
        Vec3(0.6883511000000001, -0.5598794, 0.256282),
        Vec3(-0.2722394, 0.6614441000000001, -0.5843805),
        Vec3(-0.23324140000000002, 0.7251953000000001, -0.6403722000000001),
        Vec3(-0.2221682, 0.6596615, -0.5034993),
        Vec3(-0.1813152, 0.07128240000000001, -0.9048176),
        Vec3(-0.17639210000000002, -0.0271744, -0.8916841),
        Vec3(-0.20977960000000004, 0.08605000000000002, -0.9970314),
        Vec3(0.6146244000000001, -0.6879929, 0.8376712),
        Vec3(0.5324465, -0.7183905, 0.8841506000000001),
        Vec3(0.6642264, -0.7749945, 0.8201756),
        Vec3(0.2887544, 0.8612615, 0.0453821),
        Vec3(0.2452117, 0.8047637000000001, -0.0251289),
        Vec3(0.2348751, 0.9285636, 0.08956420000000001),
        Vec3(-0.8475558, -0.8180718000000001, 0.6501232),
        Vec3(-0.803431, -0.8945692, 0.6891221000000001),
        Vec3(-0.8173606, -0.8179435, 0.5569319),
        Vec3(0.6714205, -0.2947903, 0.6551671),
        Vec3(0.7143284000000001, -0.2459194, 0.7270891),
        Vec3(0.7212365000000001, -0.2637046, 0.5791018),
        Vec3(0.6445003, -0.5462306, 0.5577966),
        Vec3(0.6730099, -0.4696457, 0.6073312),
        Vec3(0.6099428, -0.6099736, 0.6222859000000001),
        Vec3(-0.1818761, -0.6080111, -0.880542),
        Vec3(-0.1644534, -0.6777931, -0.9477669000000001),
        Vec3(-0.2078582, -0.5258591, -0.9215838000000001),
        Vec3(0.6037377, 0.2950576, 0.2863541),
        Vec3(0.6409766000000001, 0.3757001, 0.2570754),
        Vec3(0.5577033, 0.2617474, 0.20905870000000004),
        Vec3(-0.7731645, 0.33376680000000003, 0.3301121),
        Vec3(-0.8345957, 0.40272220000000003, 0.3589257),
        Vec3(-0.8130328000000001, 0.28452380000000005, 0.2577949)
    };
    context.setPositions(positions);
    State state = context.getState(State::Energy | State::Forces);
    std::cout << state.getPotentialEnergy()/4.184<< std::endl;
    for (int i = 0; i < 20; i++)
        std::cout << i<<" "<<state.getForces()[i]/41.84<< std::endl;
}

int main() {
    try {
        registerAmoebaReferenceKernelFactories();
        testWaterDimer();
        testWaterBox();
    }
    catch (const std::exception& e) {
        std::cout << "exception: " << e.what() << std::endl;
        return 1;
    }
    std::cout << "Done" << std::endl;
    return 0;
}
